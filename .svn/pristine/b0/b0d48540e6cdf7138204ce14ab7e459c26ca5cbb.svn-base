////*********************************************************
//
//    <copyright file="cuentan.cs" company="Marketing Software de Colombia LTDA">
//    @Autor Ingrid Sutachan
//    @fecha 01 marzo 2014
//    </copyright>
//
////*********************************************************
namespace Negocios.Contable
{
    using System;
    using System.Collections.Generic;
    using Datos.Contable;
    using Entities;
    using Entities.Types;

    /// <summary>
    /// Clase de Cuenta
    /// </summary>
    public class Cuentan
    {
        /// <summary>
        /// instancia capa de datosinstancia capa de datos
        /// </summary>
        private Cuentac persistencia;

        /// <summary>
        /// Initializes a new instance of the <see cref="Cuentan"/> class.
        /// </summary>
        public Cuentan()
        {
            this.persistencia = new Cuentac();
        }

        /// <summary>
        /// Cargar  cuenta.
        /// </summary>
        /// <returns>Lista de todas las cuentas</returns>
        public List<AsientosDataSource> CargarCuenta()
        {
            List<AsientosDataSource> cuenta = new List<AsientosDataSource>();
            try
            {
                var items = this.persistencia.CargarCuenta();
                foreach (var item in items)
                {
                    AsientosDataSource ds = new AsientosDataSource();
                    ds.Cuenta = item.cuenta;
                    ds.Cia = item.idcompania;
                    ds.Tipocta = item.tipocta;
                    ds.Nombre = item.nombre;
                    ds.Pidenit = item.pidenit;
                    ds.Centro = item.centro;
                    ds.Ajusteinteg = item.ajustesinteg;
                    ds.Nitajustes = item.nitajustes;
                    ds.Cueaju = item.cueaju;
                    ds.Cuencorre = item.cuencorre;
                    ds.Ajudoc = item.ajudoc;
                    ds.Porete = item.porete;
                    ds.Cuentret = item.cuentret;
                    ds.Concepret = item.concepret;
                    ds.Cuentacierreimp = item.cuentacierreimp;
                    cuenta.Add(ds);
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return cuenta;
        }

        /// <summary>
        /// Verifica cuenta.
        /// </summary>
        /// <param name="cuenta">cuenta que se verificara</param>
        /// <returns>booleano que rectifica si existe o no la cuenta</returns>
        public bool ExisteCuenta(string cuenta)
        {
            bool result = false;
            try
            {
                result = this.persistencia.ExisteCuenta(cuenta);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return result;
        }

        /// <summary>
        /// Devolvuelve the datos.
        /// </summary>
        /// <param name="id">identificador de la cuenta</param>
        /// <returns>cuenta respectiva al identificador</returns>
        public AsientosDataSource DevolverDatos(string id)
        {
            AsientosDataSource datos = new AsientosDataSource();
            try
            {
                var item = this.persistencia.DevuelveDatos(id);
                datos.Cuenta = item.cuenta;
                datos.Cia = item.idcompania;
                datos.Tipocta = item.tipocta == "M" ? "MAYOR" : "AUXILIAR";
                datos.Nombre = item.nombre;
                datos.Pidenit = item.pidenit;
                datos.Centro = item.centro;
                datos.Ajusteinteg = item.ajustesinteg;
                datos.Nitajustes = item.nitajustes;
                datos.Cueaju = item.cueaju;
                datos.Cuencorre = item.cuencorre;
                datos.Porete = item.porete;
                datos.Concepret = item.concepret;
                datos.Cuentret = item.cuentret;
                datos.Cuentacierreimp = item.cuentacierreimp;
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return datos;
        }

        /// <summary>
        /// Guardar cuenta.
        /// </summary>
        /// <param name="cuenta">Cuenta a guardar</param>
        /// <returns>cuenta que fue guardada</returns>
        public bool GuardarCuenta(AsientosDataSource cuenta)
        {
            bool result = false;
            maeconta campo = new maeconta();
            try
            {
                campo.cuenta = cuenta.Cuenta;
                campo.idcompania = cuenta.Cia;
                campo.tipocta = cuenta.Tipocta;
                campo.nombre = cuenta.Nombre;
                campo.pidenit = cuenta.Pidenit;
                campo.centro = cuenta.Centro;
                campo.ajustesinteg = cuenta.Ajusteinteg;
                campo.nitajustes = cuenta.Nitajustes;
                campo.cueaju = cuenta.Cueaju;
                campo.cuencorre = cuenta.Cuencorre;
                campo.porete = cuenta.Porete;
                campo.concepret = cuenta.Concepret;
                campo.cuentacierreimp = cuenta.Cuentacierreimp;
                result = this.persistencia.GuardarCuenta(campo);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return result;
        }

        /// <summary>
        /// Actualizar  cuenta.
        /// </summary>
        /// <param name="cuenta">cuenta a actualizar</param>
        /// <returns>cuenta que fue actualizada</returns>
        public bool ActualizarCuenta(AsientosDataSource cuenta)
        {
            bool result = false;
            maeconta campo = new maeconta();
            try
            {
                campo.cuenta = cuenta.Cuenta;
                campo.idcompania = cuenta.Cia;
                campo.tipocta = cuenta.Tipocta;
                campo.nombre = cuenta.Nombre;
                campo.pidenit = cuenta.Pidenit;
                campo.centro = cuenta.Centro;
                campo.ajustesinteg = cuenta.Ajusteinteg;
                campo.nitajustes = cuenta.Nitajustes;
                campo.cueaju = cuenta.Cueaju;
                campo.cuencorre = cuenta.Cuencorre;
                campo.porete = cuenta.Porete;
                campo.concepret = cuenta.Concepret;
                campo.cuentacierreimp = cuenta.Cuentacierreimp;
                result = this.persistencia.ActualizarCuenta(campo);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return result;
        }

        /// <summary>
        /// Eliminar cuenta.
        /// </summary>
        /// <param name="id">Identificador de cuenta a eliminar</param>
        /// <returns>booleano que rectifica si la cuenta fue eliminada</returns>
        public bool EliminarCuenta(string id)
        {
            bool result = false;
            try
            {
                result = this.persistencia.EliminarCuenta(id);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return result;
        }

        /// <summary>
        /// Buscar cuenta.
        /// </summary>
        /// <param name="buscar">Texto a buscar dentro de la tabla cuenta</param>
        /// <returns>lista de cuentas que contengan el respectivo texto</returns>
        public List<AsientosDataSource> BuscarCuenta(string buscar)
        {
            List<AsientosDataSource> cuenta = new List<AsientosDataSource>();
            try
            {
                var items = this.persistencia.BuscarCuentac(buscar);

                foreach (var item in items)
                {
                    AsientosDataSource ds = new AsientosDataSource();
                    ds.Cuenta = item.cuenta;
                    ds.Cia = item.idcompania;
                    ds.Tipocta = item.tipocta;
                    ds.Nombre = item.nombre;
                    ds.Pidenit = item.pidenit;
                    ds.Centro = item.centro;
                    ds.Ajusteinteg = item.ajustesinteg;
                    ds.Nitajustes = item.nitajustes;
                    ds.Cueaju = item.cueaju;
                    ds.Cuencorre = item.cuencorre;
                    ds.Ajudoc = item.ajudoc;
                    ds.Porete = item.porete;
                    ds.Cuentret = item.cuentret;
                    ds.Concepret = item.concepret;
                    ds.Cuentacierreimp = item.cuentacierreimp;
                    cuenta.Add(ds);
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return cuenta;
        }

        /// Devolvuelve the datos.
        /// </summary>
        /// <param name="id">identificador de la cuenta</param>
        /// <returns>cuenta respectiva al identificador</returns>
        public AsientosDataSource BuscarporNombreoCuenta(string id)
        {
            AsientosDataSource datos = new AsientosDataSource();
            try
            {
                var item = this.persistencia.BuscarporNombreoCuenta(id);
                datos.Cuenta = item.cuenta;
                datos.Cia = item.idcompania;
                datos.Tipocta = item.tipocta == "G" ? "General" : "Detalle";
                datos.Nombre = item.nombre;
                datos.Pidenit = item.pidenit;
                datos.Centro = item.centro;
                datos.Ajusteinteg = item.ajustesinteg;
                datos.Nitajustes = item.nitajustes;
                datos.Cueaju = item.cueaju;
                datos.Cuencorre = item.cuencorre;
                datos.Porete = item.porete;
                datos.Concepret = item.concepret;
                datos.Cuentacierreimp = item.cuentacierreimp;
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return datos;
        }

        /// <summary>
        /// Verifica cuenta.
        /// </summary>
        /// <param name="cuenta">cuenta que se verificara</param>
        /// <returns>booleano que rectifica si existe o no la cuenta</returns>
        public bool VerificaxNombreoCuenta(string cuenta)
        {
            bool result = false;
            try
            {
                result = this.persistencia.VerificaxNombreoCuenta(cuenta);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return result;
        }

        public List<AsientosDataSource> CargarCuentaDetalle()
        {
            List<AsientosDataSource> cuenta = new List<AsientosDataSource>();
            try
            {
                var items = this.persistencia.CargarCuentaDetalle();
                foreach (var item in items)
                {
                    AsientosDataSource ds = new AsientosDataSource();
                    ds.Cuenta = item.cuenta;
                    ds.Cia = item.idcompania;
                    ds.Tipocta = item.tipocta;
                    ds.Nombre = item.nombre;
                    ds.Pidenit = item.pidenit;
                    ds.Centro = item.centro;
                    ds.Ajusteinteg = item.ajustesinteg;
                    ds.Nitajustes = item.nitajustes;
                    ds.Cueaju = item.cueaju;
                    ds.Cuencorre = item.cuencorre;
                    ds.Ajudoc = item.ajudoc;
                    ds.Porete = item.porete;
                    ds.Cuentret = item.cuentret;
                    ds.Concepret = item.concepret;
                    ds.Cuentacierreimp = item.cuentacierreimp;
                    cuenta.Add(ds);
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return cuenta;
        }

        public string DevolverNombre(string codigo)
        {
            string nombre;
            try
            {
                nombre = this.persistencia.DevolverNombre(codigo);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return nombre;
        }

        public List<AsientosDataSource> CargarCuentaReporte(int compania)
        {
            List<AsientosDataSource> cuenta = new List<AsientosDataSource>();
            try
            {
                var items = this.persistencia.CargarCuentaReporte(compania);
                foreach (var item in items)
                {
                    AsientosDataSource ds = new AsientosDataSource();
                    ds.Cuenta = item.cuenta;
                    ds.Cia = item.idcompania;
                    ds.Tipocta = item.tipocta == "M" ? "MAYOR" : "AUXILIAR";
                    ds.Nombre = item.nombre;
                    ds.Pidenit = item.pidenit;
                    ds.Centro = item.centro;
                    ds.Ajusteinteg = item.ajustesinteg;
                    ds.Nitajustes = item.nitajustes;
                    ds.Cueaju = item.cueaju;
                    ds.Cuencorre = item.cuencorre;
                    ds.Ajudoc = item.ajudoc;
                    ds.Porete = item.porete;
                    ds.Cuentret = item.cuentret;
                    ds.Concepret = item.concepret;
                    ds.Cuentacierreimp = item.cuentacierreimp;
                    ds.NombreCia = item.compania.nombrecia;
                    ds.Nit = item.compania.nit;
                    cuenta.Add(ds);
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return cuenta;
        }

        public bool VerificarCuentaVal(string cuenta)
        {
            bool result = false;
            try
            {
                result = this.persistencia.ExisteCuentaVal(cuenta);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return result;
        }

        public string DevolverTipoCuenta(string cuenta)
        {
            string tipo;
            try
            {
                tipo = this.persistencia.DevolverTipoCuenta(cuenta);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return tipo;
        }

        public bool ExisteBuscar(string buscar)
        {
            bool existe = false;
            try
            {
                existe = this.persistencia.ExisteBuscar(buscar);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return existe;
          }
    }
}
