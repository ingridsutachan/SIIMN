using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using App.Forms.Contable.Reportes.Types;
using Entities.Types;
using Negocios.Contable;
using Negocios.General;

namespace App.Forms.Contable.Reportes
{
    public partial class Form_ReporteNits : Form
    {
        private Nitsn negocioNits;

        private Frmnits frmnits;

        private Empresan negocioEmpresa;

        public Form_ReporteNits()
        {
            this.negocioNits = new Nitsn();
            this.negocioEmpresa = new Empresan();
            this.InitializeComponent();
        }

        public Form_ReporteNits(Frmnits frmnits)
        {
            // TODO: Complete member initialization
            this.frmnits = frmnits;
            this.negocioNits = new Nitsn();
            this.negocioEmpresa = new Empresan();
            this.InitializeComponent();
        }

        private void btn_ordenumero_Click(object sender, EventArgs e)
        {
            List<NitsDataSource> nits = new List<NitsDataSource>();
            nits = this.negocioNits.CargarNitsReporteOrdNombre();
            this.GenerarReporte(nits);
        }

        private void btn_ordenombre_Click(object sender, EventArgs e)
        {
            List<NitsDataSource> nits = new List<NitsDataSource>();
            nits = this.negocioNits.CargarNitsReporteOrdeNumero();
            this.GenerarReporte(nits);
        }

        private void GenerarReporte(List<NitsDataSource> nits)
        {
            List<NitsDataSourceReports> nitsR = new List<NitsDataSourceReports>();
            EmpresaDataSource empresa = new EmpresaDataSource();
            empresa = this.negocioEmpresa.DevolverDatosEmpresa(Program.compa);
            foreach (NitsDataSource item in nits)
            {
                NitsDataSourceReports nitR = new NitsDataSourceReports();
                nitR.Nit = item.Nit;
                nitR.Digito = item.Digito;
                nitR.Tiponit = item.Tiponit;
                nitR.Nombrenit = item.Nombrenit;
                nitR.Direccion = item.Direccion;
                nitR.Telefono = item.Telefono;
                nitR.Celular = item.Celular;
                nitR.Idpais = item.IdPais;
                nitR.Iddepartamento = item.IdDepto;
                nitR.Idciudad = item.Idciudad;
                nitR.Compania_nits = empresa.Nombrecia;
                nitsR.Add(nitR);
            }
            ReporteNits reportnit = new ReporteNits();
            reportnit.SetDataSource(nitsR);
            crystal_reportnits.ReportSource = reportnit;
            this.Width = 1009;
            this.Height = 397;
            crystal_reportnits.Zoom(90);
            crystal_reportnits.Visible = true;
            btn_ordenombre.Visible = false;
            btn_ordenumero.Visible = false;
        }
    }
}
